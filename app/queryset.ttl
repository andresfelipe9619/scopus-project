PREFIX iter: <http://w3id.org/sparql-generate/iter/>
PREFIX fun: <http://w3id.org/sparql-generate/fn/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX fo: <http://www.w3.org/1999/XSL/Format#>
PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>
PREFIX bibo: <http://purl.org/ontology/bibo/>
PREFIX dcterm: <http://purl.org/dc/terms/>
PREFIX prism21: <http://prismstandard.org/namespaces/basic/2.1/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX fabio: <http://purl.org/spar/fabio/>
PREFIX cito: <http://purl.org/spar/cito/>

GENERATE { 
  
  ?documentsIRI
    a bibo:Article;
    bibo:authorsList ?authors;
    dcterm:identifier ?authors_id;
    dc:subject ?title;
    fabio:hasPublicationYear ?year;
    prism21:alternateTitle ?src_title;
    prism21:volume ?volume;
    bibo:number ?issue;
    bibo:abstract ?abstract;
    prism21:startingPage ?pag__start;
    prism21:endingPage ?pag_end;
    bibo:numPages ?pag_count;
    cito:isCitedBy ?cited_by;
    prism21:doi ?doi;    
    rdfs:label ?link;
    fabio:BibliographicDatabase ?art_source;
}
SOURCE <http://example.com/scopus.json> AS ?source
ITERATOR iter:JSONPath(?source,"$[*]") AS ?work
WHERE {
  BIND (IRI( REPLACE( CONCAT("http://ex.com/documents/",fun:JSONPath(?work,"$.Title")) , " " , "_" ) ) as ?documentsIRI)
  BIND (fun:JSONPath(?work,"$.Authors") AS ?authors)
  BIND (fun:JSONPath (?work,"$.['Author(s) ID']") AS ?authors_id)
  BIND(fun:JSONPath(?work,"$.Title") AS ?title)
   BIND(fun:JSONPath(?work,"$.Year") AS ?year)
  BIND(fun:JSONPath(?work,"$.['Source title']") AS ?src_title)
   BIND(fun:JSONPath(?work,"$.Volume") AS ?volume)
  BIND (fun:JSONPath(?work,"$.Issue") AS ?issue)
  BIND(fun:JSONPath(?work,"$.['Page start']") AS ?pag__start)
  BIND(fun:JSONPath(?work,"$.['Page end']") AS ?pag_end)
  BIND(fun:JSONPath(?work,"$.['Page count']") AS ?pag_count)
  BIND(fun:JSONPath(?work,"$.['Cited by']") AS ?cited_by)
  BIND (fun:JSONPath(?work,"$.DOI") AS ?doi)
    BIND (fun:JSONPath(?work,"$.Link") AS ?link)
   BIND(fun:JSONPath(?work,"$.Abstract") AS ?abstract)
   BIND(fun:JSONPath(?work,"$.Source") AS ?art_source)
}

